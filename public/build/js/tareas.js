!function(){!async function(){try{const t="/api/tareas?token="+i(),o=await fetch(t),n=await o.json();e=n,a()}catch(e){console.log(e)}}();let e=[],t=[];document.querySelector("#agregar-tarea").addEventListener("click",()=>{o()});function a(){!function(){const e=document.querySelector("#listado-tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.estado),a=document.querySelector("#pendiente");if(0===t.length)return void(a.disabled=!0);a.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.estado),a=document.querySelector("#completas");if(0===t.length)return void(a.disabled=!0);a.disabled=!1}();const n=t.length?t:e,c=document.querySelector("#listado-tareas");if(0===n.length){const e=document.createElement("li");return e.textContent="No hay tareas",e.classList.add("no-tareas"),void c.appendChild(e)}const d={0:"Pendiente",1:"Completo"};n.forEach(t=>{const{id:n,nombre:s,estado:l}=t,m=document.createElement("li");m.dataset.tareaId=n,m.classList.add("tarea");const u=document.createElement("p");u.textContent=s,u.ondblclick=()=>{o(!0,{...t})};const p=document.createElement("div");p.classList.add("opciones");const f=document.createElement("button");f.classList.add("estado-tarea",""+d[l].toLowerCase()),f.textContent=d[l],f.dataset.estadoTarea=l,f.ondblclick=()=>{!function(e){const t="1"===e.estado?"0":"1";e.estado=t,r(e)}({...t})};const h=document.createElement("button");h.classList.add("eliminar-tarea"),h.dataset.idTarea=n,h.textContent="Eliminar",h.ondblclick=()=>{!function(t){Swal.fire({title:"Eliminar Tarea?",text:"Se eliminará la tarea por completo!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Eliminar!"}).then(o=>{o.isConfirmed&&async function(t){const{estado:o,id:n,nombre:r}=t,c=new FormData;c.append("id",n),c.append("nombre",r),c.append("estado",o),c.append("proyectoId",i());try{const t="http://localhost:3000/api/tarea/eliminar",o=await fetch(t,{method:"POST",body:c});"exito"===(await o.json()).tipo&&(Swal.fire({position:"top-end",icon:"success",title:"Eliminado",showConfirmButton:!1,timer:1e3}),e=e.filter(e=>e.id!==n),a())}catch(e){console.log(e)}}(t)})}({...t})},p.appendChild(f),p.appendChild(h),m.appendChild(u),m.appendChild(p),c.appendChild(m)})}function o(t=!1,o={}){const{id:c,nombre:d}=o,s=document.createElement("div");s.classList.add("modal"),s.innerHTML=`\n            <form class='formulario nueva-tarea'>\n                <legend>${t?"Editar Tarea":"Añade una nueva tarea"}</legend>\n                <div class='campo'>\n                    <label for='tarea'>Tarea</label>\n                    <input type='text' name='tarea' id='tarea' placeholder='${d?"Editar la Tarea":"Escribe la Tarea"}' value='${d||""}'>\n                </div>\n\n                <div class='opciones'>\n                    <input type='submit' class='submit-nueva-tarea' value='${t?"Actualizar Tarea":"Crear Tarea"}'>\n                    <button type='button' class='cerrar-modal'>Cancelar</button>\n                </div>\n            </form>\n        `,setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0),document.querySelector("body").appendChild(s),s.addEventListener("click",c=>{if(c.preventDefault(),c.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{s.remove()},500)}if(c.target.classList.contains("submit-nueva-tarea")){const c=document.querySelector("#tarea").value.trim();if(""===c)return void n("El nombre de la tarea es obligatorio","error",document.querySelector(".formulario legend"));if(t)return o.nombre=c,void r(o);!async function(t){const o=new FormData;o.append("nombre",t),o.append("proyectoId",i());try{const r="http://localhost:3000/api/tarea",i=await fetch(r,{method:"POST",body:o}),c=await i.json();if(n(c.mensaje,c.tipo,document.querySelector(".formulario legend")),"exito"===c.tipo){const o=document.querySelector(".modal");setTimeout(()=>{o.remove()},2e3);const n={id:String(c.id),nombre:t,estado:"0",proyectoId:c.proyectoId};e=[...e,n],a()}}catch(e){console.log(e)}}(c)}})}function n(e,t,a){const o=document.querySelector(".alertas");o&&o.remove();const n=document.createElement("div");n.classList.add("alertas",t),n.textContent=e,a.parentElement.insertBefore(n,a.nextElementSibling),setTimeout(()=>{n.remove()},2e3)}async function r(t){const{estado:o,id:n,nombre:r}=t,c=new FormData;c.append("id",n),c.append("nombre",r),c.append("estado",o),c.append("proyectoId",i());try{const t="http://localhost:3000/api/tarea/actualizar",i=await fetch(t,{method:"POST",body:c});if("exito"===(await i.json()).tipo){const t=document.querySelector(".modal");t&&t.remove(),Swal.fire({position:"top-end",icon:"success",title:"Actualizado Correctamente",showConfirmButton:!1,timer:1500}),e=e.map(e=>(e.id===n&&(e.estado=o,e.nombre=r),e)),a()}}catch(e){console.log(e)}}function i(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).token}document.querySelectorAll('#filtros input[type="radio"').forEach(o=>{o.addEventListener("input",o=>{const n=o.target.value;if(""===n)return t=[],void a();t=e.filter(e=>e.estado===n),a()})})}();
//# sourceMappingURL=tareas.js.map
