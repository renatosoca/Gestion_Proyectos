!function(){!async function(){try{const a="/api/tareas?token="+r(),o=await fetch(a),n=await o.json();e=n,t()}catch(e){console.log(e)}}();let e=[];function t(){!function(){const e=document.querySelector("#listado-tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}();const o=document.querySelector("#listado-tareas");if(0===e.length){const e=document.createElement("li");return e.textContent="No hay tareas",e.classList.add("no-tareas"),void o.appendChild(e)}const i={0:"Pendiente",1:"Completo"};e.forEach(c=>{const{id:d,nombre:s,estado:l}=c,m=document.createElement("li");m.dataset.tareaId=d,m.classList.add("tarea");const u=document.createElement("p");u.textContent=s,u.ondblclick=()=>{a(!0,{...c})};const p=document.createElement("div");p.classList.add("opciones");const f=document.createElement("button");f.classList.add("estado-tarea",""+i[l].toLowerCase()),f.textContent=i[l],f.dataset.estadoTarea=l,f.ondblclick=()=>{!function(e){const t="1"===e.estado?"0":"1";e.estado=t,n(e)}({...c})};const h=document.createElement("button");h.classList.add("eliminar-tarea"),h.dataset.idTarea=d,h.textContent="Eliminar",h.ondblclick=()=>{!function(a){Swal.fire({title:"Eliminar Tarea?",text:"Se eliminará la tarea por completo!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Eliminar!"}).then(o=>{o.isConfirmed&&async function(a){const{estado:o,id:n,nombre:i}=a,c=new FormData;c.append("id",n),c.append("nombre",i),c.append("estado",o),c.append("proyectoId",r());try{const a="http://localhost:3000/api/tarea/eliminar",o=await fetch(a,{method:"POST",body:c});"exito"===(await o.json()).tipo&&(Swal.fire({position:"top-end",icon:"success",title:"Eliminado",showConfirmButton:!1,timer:1e3}),e=e.filter(e=>e.id!==n),t())}catch(e){console.log(e)}}(a)})}({...c})},p.appendChild(f),p.appendChild(h),m.appendChild(u),m.appendChild(p),o.appendChild(m)})}function a(a=!1,i={}){const{id:c,nombre:d}=i,s=document.createElement("div");s.classList.add("modal"),s.innerHTML=`\n            <form class='formulario nueva-tarea'>\n                <legend>${a?"Editar Tarea":"Añade una nueva tarea"}</legend>\n                <div class='campo'>\n                    <label for='tarea'>Tarea</label>\n                    <input type='text' name='tarea' id='tarea' placeholder='${d?"Editar la Tarea":"Escribe la Tarea"}' value='${d||""}'>\n                </div>\n\n                <div class='opciones'>\n                    <input type='submit' class='submit-nueva-tarea' value='${a?"Actualizar Tarea":"Crear Tarea"}'>\n                    <button type='button' class='cerrar-modal'>Cancelar</button>\n                </div>\n            </form>\n        `,setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0),document.querySelector("body").appendChild(s),s.addEventListener("click",c=>{if(c.preventDefault(),c.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{s.remove()},500)}if(c.target.classList.contains("submit-nueva-tarea")){const c=document.querySelector("#tarea").value.trim();if(""===c)return void o("El nombre de la tarea es obligatorio","error",document.querySelector(".formulario legend"));if(a)return i.nombre=c,void n(i);!async function(a){const n=new FormData;n.append("nombre",a),n.append("proyectoId",r());try{const r="http://localhost:3000/api/tarea",i=await fetch(r,{method:"POST",body:n}),c=await i.json();if(o(c.mensaje,c.tipo,document.querySelector(".formulario legend")),"exito"===c.tipo){const o=document.querySelector(".modal");setTimeout(()=>{o.remove()},2e3);const n={id:String(c.id),nombre:a,estado:"0",proyectoId:c.proyectoId};e=[...e,n],t()}}catch(e){console.log(e)}}(c)}})}function o(e,t,a){const o=document.querySelector(".alertas");o&&o.remove();const n=document.createElement("div");n.classList.add("alertas",t),n.textContent=e,a.parentElement.insertBefore(n,a.nextElementSibling),setTimeout(()=>{n.remove()},2e3)}async function n(a){const{estado:o,id:n,nombre:i}=a,c=new FormData;c.append("id",n),c.append("nombre",i),c.append("estado",o),c.append("proyectoId",r());try{const a="http://localhost:3000/api/tarea/actualizar",r=await fetch(a,{method:"POST",body:c});if("exito"===(await r.json()).tipo){const a=document.querySelector(".modal");a&&a.remove(),Swal.fire({position:"top-end",icon:"success",title:"Actualizado Correctamente",showConfirmButton:!1,timer:1500}),e=e.map(e=>(e.id===n&&(e.estado=o,e.nombre=i),e)),t()}}catch(e){console.log(e)}}function r(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).token}document.querySelector("#agregar-tarea").addEventListener("click",()=>{a()})}();
//# sourceMappingURL=tareas.js.map
